DROP TABLE;	
SELECT * FROM TAB;
CREATE TABLE
(
);

------------------------------------------------------------------------------

		YEAR-2007,QUESTION-6
DROP TABLE BRANCH;
CREATE TABLE BRANCH
(	BRANCH_NAME VARCHAR2(30),
	BRANCH_CITY VARCHAR2(30),
	ASSETS NUMBER(9,2),
	PRIMARY KEY(BRANCH_NAME)
);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('KOLKATA_BRANCH','KOLKATA',15000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('DURGAPUR_BRANCH','DURGAPUR',874330);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('DELHI_BRANCH','DELHI',34760.50);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('MIDNAPUR_BRANCH','MIDNAPUR',5000);


DROP TABLE CUSTOMER;
CREATE TABLE CUSTOMER
(	CUSTOMER_NAME VARCHAR2(30),
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(CUSTOMER_NAME)
);
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.DAS','S.R.STREET','KOLKATA');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.BOSE','A.P.J.ROY STREET','GUJRAT');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.HAJRA','G.M. STREET','PANJAB');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MRS ROY','K.K.STREET','DURGAPUR');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.SING','M.R.STREET','DELHI');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.SRIBASTAB','K.A.R.STREET','CHENNAI');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.KAR','A.R.STREET','KOLKATA);
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.SINGHANIA','B.K.STREET','HOWRAH');


DROP TABLE LOAN;
CREATE TABLE LOAN
(	BRANCH_NAME VARCHAR2(30),
	LOAN_NO INT,
	AMOUNT NUMBER(8,2),
	PRIMARY KEY(LOAN_NO)
);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('KOLKATA_BRANCH',102,5600);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('DURGAPUR_BRANCH',62,5600);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('MIDNAPUR_BRANCH',107,87400);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('DURGAPUR_BRANCH',234,870552);

DROP TABLE ACCOUNT;
CREATE TABLE ACCOUNT
(	BRANCH_NAME VARCHAR2(30),
	ACCOUNT_NO INT,
	BALANCE NUMBER(8,2),
	PRIMARY KEY(ACCOUNT_NO)
);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('KOLKATA_BRANCH',12,654354);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('DURGAPUR_BRANCH',098,5600);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('DURGAPUR_BRANCH',11,54320);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('MIDNAPUR_BRANCH',455,783540);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('DURGAPUR_BRANCH',112,5900);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('DELHI_BRANCH',132,60070);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('DURGAPUR_BRANCH',153,764000);

DROP TABLE BORROWER;
CREATE TABLE BORROWER
(	CUSTOMER_NAME VARCHAR2(30),
	LOAN_NO INT,
	PRIMARY KEY(CUSTOMER_NAME,LOAN_NO)
);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.DAS',102);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.HAJRA',62);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.BOSE',107);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.KAR',234);

DROP TABLE DEPOSITOR;
CREATE TABLE DEPOSITOR
(	CUSTOMER_NAME VARCHAR2(30),
	ACCOUNT_NO INT,
	PRIMARY KEY(CUSTOMER_NAME,ACCOUNT_NO)
);
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR. DAS',12);
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SINGHANIA',11);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.KAR',98);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MRS.ROY',132);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',455);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SHING',153);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SRIBASTAB',112);  
---------------------------------------------------------------------------

		YEAR-2007,QUESTION-7
DROP TABLE EMPLOYEE;
CREATE TABLE EMPLOYEE
(	EMP_NAME VARCHAR2(30),
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(EMP_NAME)
);
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR. SAHA','B.B.LANE','SILIGURI');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR. BANERJEE','PARKSTREET','KOLKATA');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR. SHARMA','T.M. SARANI','SILIGURI');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR .DEY','L.H. STREET','KAKURGACHI');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR. SINHA','PARKSTREET','KOLKATA');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MRS. ROY','KALITOLA LANE','BAKURA');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR. GHOSH','A.J.C. BOSE ROAD','KOLKATA');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MRS. ALI','K.K. MITRA SARANI','KOLAGHAT');
INSERT INTO EMPLOYEE(EMP_NAME,STREET,CITY) VALUES('MR.KARMOKAR','B.N.S. STREET','RACHI');
SELECT * FROM EMPLOYEE;

DROP TABLE COMPANY;
CREATE TABLE COMPANY
(	COMPANY_NAME VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(COMPANY_NAME),
	CONSTRAINT CMP_NM CHECK(COMPANY_NAME IN ('IOC','ABC','XYZ'))
);
INSERT INTO COMPANY(COMPANY_NAME,CITY) VALUES('IOC','KOLKATA');
INSERT INTO COMPANY(COMPANY_NAME,CITY) VALUES('XYZ','MIDNAPUR');
INSERT INTO COMPANY(COMPANY_NAME,CITY) VALUES('ABC','JOLPAIGURI');
SELECT * FROM COMPANY;

DROP TABLE WORKS;
CREATE TABLE WORKS
(	EMP_NAME VARCHAR2(30),
	COMPANY_NAME VARCHAR2(40),
	SALARY NUMBER(7,2) DEFAULT 10000,
	PRIMARY KEY(EMP_NAME,COMPANY_NAME),
	CONSTRAINT CMP_NM1 CHECK(COMPANY_NAME IN ('IOC','ABC','XYZ'))
);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MR. SAHA','ABC',45000);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MR. SHARMA','IOC',12000);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME) VALUES('MR. DEY','ABC');
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MR. BANERJEE','XYZ',35500);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MR. SINHA','ABC',37600);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME) VALUES('MRS. ALY','IOC');
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MRS. ROY','IOC',28000);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME,SALARY) VALUES('MR. GHOSH','XYZ',40000);
INSERT INTO WORKS(EMP_NAME,COMPANY_NAME) VALUES('MRS. KARMAKAR','IOC');
SELECT * FROM WORKS;

DROP TABLE MANAGES;
CREATE TABLE MANAGES
(	EMP_NAME VARCHAR2(30),
	MANAGER_NAME VARCHAR2(30),
	PRIMARY KEY(EMP_NAME,MANAGER_NAME)
);
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. SHARMA','MR. SAHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. SHARMA','MR. BANERJEE');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. BANERJEE','MR. SINHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. DEY','MR. SAHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. SINHA','MR. SAHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MRS. ROY','MR. SINHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. ROY','MR. GHOSH');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MR. GHOSH','MR. SINHA');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MRS. ALI','MR. GHOSH');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MRS. ALI','MR. BANERJEE');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MRS. KARMAKAR','MR. GHOSH');
INSERT INTO MANAGES(EMP_NAME,MANAGER_NAME) VALUES('MRS. KARMAKAR','MR. SINHA');
SELECT * FROM MANAGES;



====================================================================================

1)
SELECT EMP_NAME,SALARY
FROM(SELECT ROWNUM NO,EMP_NAME,SALARY
FROM(SELECT EMP_NAME,SALARY FROM WORKS
	ORDER BY SALARY DESC)) SAL
WHERE SAL.NO<4;


2)
SELECT EMP_NAME
FROM EMPLOYEE,
(SELECT MANAGES.EMP_NAME EN,MANAGES.MANAGER_NAME MN,EMPLOYEE.STREET MST,EMPLOYEE.CITY MCT
FROM EMPLOYEE,MANAGES
WHERE MANAGES.MANAGER_NAME=EMPLOYEE.EMP_NAME) T
WHERE EMPLOYEE.EMP_NAME LIKE T.EN
	AND EMPLOYEE.CITY=T.MCT
	AND EMPLOYEE.STREET=T.MST;
	AND EMPLOYEE.EMP_NAME NOT LIKE T.MN;


3)
SELECT EMP_NAME
FROM WORKS
WHERE COMPANY_NAME NOT LIKE 'IOC';


4)
SELECT EMPLOYEE.EMP_NAME ENAME,EMPLOYEE.STREET ESTREET,EMPLOYEE.CITY ECITY
FROM WORKS,EMPLOYEE
WHERE EMPLOYEE.EMP_NAME=WORKS.EMP_NAME
	AND WORKS.SALARY>10000
	AND WORKS.COMPANY_NAME LIKE 'ABC';

5)
SELECT WORKS.EMP_NAME
FROM WORKS
WHERE WORKS.SALARY>
(SELECT MAX(SALARY)
FROM WORKS
WHERE COMPANY_NAME LIKE 'IOC');








-----------------------------------------------------------------------------

		YEAR-2007,QUESTION-8
DROP TABLE SAILORS;
CREATE TABLE SAILORS
(	SID INT,
	S_NAME VARCHAR2(30),
	RATING INT,
	AGE INT,
	PRIMARY KEY(SID),
	CONSTRAINT SD CHECK(SID BETWEEN 100 AND 1000)
);

INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(112,'MR. REY',8,34);
INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(512,'MR. BROWN',7,31);
INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(328,'MR. SAHA',6,28);
INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(718,'MR. DISUZA',9,45);
INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(102,'MR. CLERK',7,32);
INSERT INTO SAILOR(SID,S_NAME,RATING,AGE) VALUES(905,'MR. AKRAM',8,54);


DROP TABLE BOATS1;
CREATE TABLE BOATS1
(	
	BID INT,
	BNAME VARCHAR2(30),
	COLOUR VARCHAR2(10),
	PRIMARY KEY(BID),
	CONSTRAINT BD CHECK(BID BETWEEN 100 AND 300),
	CONSTRAINT CLR CHECK(COLOUR IN ('RED','YELLOW','BLUE','GREEN'))
);	

INSERT INTO BOATS1(BID,BNAME,COLOUR) VALUES(233,'QUEENS MARY','BLUE');
INSERT INTO BOATS1(BID,BNAME,COLOUR) VALUES(135,'QUEENS MARY2','YELLOW');
INSERT INTO BOATS1(BID,BNAME,COLOUR) VALUES(118,'TITANIC','GREEN');
INSERT INTO BOATS1(BID,BNAME,COLOUR) VALUES(300,'ELIZABETH','RED');

DROP TABLE RESERVES;
CREATE TABLE RESERVES
(	SID INT,
	BID INT,
	DAY INT,
	PRIMARY KEY(SID,BID),
	CONSTRAINT SD1 CHECK(SID BETWEEN 100 AND 1000),
	CONSTRAINT BD1 CHECK(BID BETWEEN 100 AND 300)
);

INSERT INTO RESERVES(SID,BID,DAY) VALUES(112,135,156);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(112,300,80);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(512,233,185);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(328,135,90);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(328,300,90);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(102,118,120);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(905,233,365);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(112,118,52);
INSERT INTO RESERVES(SID,BID,DAY) VALUES(112,233,380);

SELECT * FROM RESERVES;
SELECT * FROM BOATS1;





(SELECT SID 
FROM BOATS1,RESERVES
WHERE BOATS1.BID= RESERVES.BID AND
COLOUR=’RED’)
MINUS
(SELECT SID 
FROM BOATS1,RESERVES
WHERE BOATS1.BID= RESERVES.BID AND
COLOUR=’GREEN’);--------------------------------------*


SELECT S_NAME
FROM SAILOR,(SELECT SID
		FROM RESERVES
		WHERE BID=118) SD--------------------OK
WHERE SAILOR.SID=SD.SID;



SELECT S_NAME
FROM SAILOR,((SELECT SID
FROM BOATS1,RESERVES
WHERE COLOUR='RED' AND BOATS1.BID=RESERVES.BID)
INTERSECT
(SELECT SID
FROM BOATS1,RESERVES
WHERE COLOUR='GREEN' AND BOATS1.BID=RESERVES.BID))BT
WHERE SAILOR.SID=BT.SID;--------------------ok

SELECT S_NAME
FROM SAILOR,(SELECT SID
FROM (SELECT SID,COUNT(BID)NO_BOATS
	FROM RESERVES
	GROUP BY SID)BT1
WHERE BT1.NO_BOATS IN (SELECT COUNT(BID) NO_BOATS
			FROM BOATS1))COUNT
WHERE SAILOR.SID=COUNT.SID;---------------------ok


SELECT S_NAME
FROM SAILOR,(SELECT SID
FROM RESERVES,BOATS1
WHERE COLOUR='BLUE' AND BOATS1.BID=RESERVES.BID)CLR
WHERE SAILOR.SID=CLR.SID;









-------------------------------------------------------------------------------

		YEAR-2007,QUESTION-9
CREATE TABLE FLIGHTS
(	FLNO VARCHAR2(30),
	FROM1 VARCHAR2(30),
	TO1 VARCHAR2(30),
	DEPARTS DATE,
	ARRIVES DATE,
	PRIMARY KEY(FLNO)
);
CREATE TABLE AIRCRAFT
(	AID VARCHAR2(10),
	ANAME VARCHAR(20),
	CRUISE_RANGE VARCHAR(20),
	PRIMARY KEY(AID)
);
CREATE TABLE EMPLOYEES
(	EID VARCHAR2(10),
	ENAME VARCHAR(20),
	SALARY NUMBER(7,2),
	PRIMARY KEY(EID)
);
CREATE TABLE CERTIFIED
(	EID VARCHAR2(10),	
	AID VARCHAR2(10),
	PRIMARY KEY(EID,AID)
);

--------------------------------------------------------------------------------

		YEAR-2007,QUESTION-10
CREATE TABLE BRANCH10
(	BNO INT,
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PIN VARCHAR2(10),
	PRIMARY KEY(BNO)
);
CREATE TABLE STAFF
(	STAFF_NO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),
	DESIGNATION VARCHAR2(20),
	SEX VARCHAR2(6),
	DOB DATE,
	BNO INT,
	PRIMARY KEY(STAFF_NO)
);
CREATE TABLE PROPERTY_FOR_RENT
(	PNO INT,
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PIN VARCHAR2(10),
	TYPE VARCHAR2(4),
	ROOMS INT,
	RENT NUMBER(6,2),
	OWNER_NO INT,
	STAFF_NO INT,
	BNO INT,
	PRIMARY KEY(PNO)
);
CREATE TABLE CLIENT
(	CNO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),	
	TELNO VARCHAR2(15),
	PREF_TYPE VARCHAR2(4),
	MAX_RENT NUMBER(6,2),
	PRIMARY KEY(CNO)
);
CREATE TABLE PRIVATE_OWNER
(	ONO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),
	ADDRESS VARCHAR2(40),
	TELNO VARCHAR2(15),
	PRIMARY KEY(ONO)
);
CREATE TABLE VIEWING
(	CNO INT,
	PNO INT,
	VIEW_DATE DATE,
	COMMENT1 VARCHAR2(50),
	PRIMARY KEY(PNO,CNO)
);

--------------------------------------------------------------------------



















	