DROP TABLE;	
SELECT * FROM TAB;
CREATE TABLE
(
);

------------------------------------------------------------------------------

		YEAR-2007,QUESTION-6(i)(d)
DROP TABLE BRANCH;
CREATE TABLE BRANCH
(	BRANCH_NAME VARCHAR2(30),
	BRANCH_CITY VARCHAR2(30),
	ASSETS NUMBER(9,2),
	PRIMARY KEY(BRANCH_NAME)
);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('SHYAMBAZAR_BRANCH','KOLKATA',15000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('KORUNAMOI_BRANCH','DURGAPUR',874330);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('M.G.ROAD_BRANCH','KOLKATA',54760.50);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('MIDNAPUR_BRANCH','MIDNAPUR',5000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('B.T.GANGULY ROAD_BRANCH','DURGAPUR',5000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('B.B.DAS ROAD_BRANCH','DURGAPUR',5000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('ESPLANADE_BRANCH','KOLKATA',12354);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('EXIDE_BRANCH','KOLKATA',15000);
INSERT INTO BRANCH(BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES('ARAMBAG_BRANCH','HUGLI',935942);
SELECT * FROM BRANCH;

DROP TABLE CUSTOMER;
CREATE TABLE CUSTOMER
(	CUSTOMER_NAME VARCHAR2(30),
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(CUSTOMER_NAME)
);
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.DAS','COLLEGE STREET','KOLKATA');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.BOSE','GARIAHAT','KOLKATA');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.HAJRA','G.M. STREET','PANJAB');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MRS ROY','GARIAHAT','KOLKATA');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MR.SING','M.R.STREET','DELHI');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.SRIBASTAB','GARIAHAT','KOLKATA');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.KAR','A.R.STREET','DURGAPUR');
INSERT INTO CUSTOMER(CUSTOMER_NAME,STREET,CITY) VALUES('MS.SINGHANIA','GARIAHAT','KOLKATA');
SELECT * FROM CUSTOMER;

DROP TABLE LOAN;
CREATE TABLE LOAN
(	BRANCH_NAME VARCHAR2(30),
	LOAN_NO INT,
	AMOUNT NUMBER(8,2),
	PRIMARY KEY(LOAN_NO)
);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('SHYAMBAZAR_BRANCH',102,5600);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('SHYAMBAZAR_BRANCH',106,6900);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('KORUNAMOI_BRANCH',062,5600);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('MIDNAPUR_BRANCH',107,87400);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('M.G.ROAD_BRANCH',234,8752);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('M.G.ROAD_BRANCH',259,70552);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('M.G.ROAD_BRANCH',613,4563);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('EXIDE_BRANCH',934,9462);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('ESPLANADE_BRANCH',631,13645);
INSERT INTO LOAN(BRANCH_NAME,LOAN_NO,AMOUNT) VALUES('B.T.GANGULY ROAD_BRANCH',632,4698);
SELECT * FROM LOAN;

DROP TABLE ACCOUNT;
CREATE TABLE ACCOUNT
(	BRANCH_NAME VARCHAR2(30),
	ACCOUNT_NO INT,
	BALANCE NUMBER(8,2),
	PRIMARY KEY(ACCOUNT_NO)
);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('SHYAMBAZAR_BRANCH',12,654354);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('KORUNAMOI_BRANCH',098,5600);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('B.T.GANGULY ROAD_BRANCH',11,54320);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('MIDNAPUR_BRANCH',455,783540);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('B.B.DAS ROAD_BRANCH',112,5900);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('ESPLANADE_BRANCH',132,60070);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('B.B.DAS ROAD_BRANCH',153,766500);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('EXIDE_BRANCH',646,14894);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('KORUNAMOI_BRANCH',634,5600);
INSERT INTO ACCOUNT(BRANCH_NAME,ACCOUNT_NO,BALANCE) VALUES('B.T.GANGULY ROAD_BRANCH',969,54320);


SELECT * FROM ACCOUNT;

DROP TABLE BORROWER;
CREATE TABLE BORROWER
(	CUSTOMER_NAME VARCHAR2(30),
	LOAN_NO INT,
	PRIMARY KEY(CUSTOMER_NAME,LOAN_NO)
);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.DAS',102);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.HAJRA',62);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.BOSE',107);
INSERT INTO BORROWER(CUSTOMER_NAME,LOAN_NO) VALUES('MR.KAR',234);
SELECT * FROM BORROWER;

DROP TABLE DEPOSITOR;
CREATE TABLE DEPOSITOR
(	CUSTOMER_NAME VARCHAR2(30),
	ACCOUNT_NO INT,
	PRIMARY KEY(CUSTOMER_NAME,ACCOUNT_NO)
);
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.DAS',12);
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SINGHANIA',11);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.KAR',98);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MRS.ROY',132);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',455);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SHING',153);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.SRIVASTAV',132);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',112);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',646);  
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',634); 
INSERT INTO DEPOSITOR(CUSTOMER_NAME,ACCOUNT_NO) VALUES('MR.BOSE',969); 
SELECT * FROM DEPOSITOR;

=======================================================================

1)
SELECT T2.CUST_NAME,T2.AVG_BAL
(SELECT T1.CST CUST_NAME,AVG(T1.ACT) AVG_BAL,COUNT(T1.CST) CT
FROM
(SELECT CUSTOMER.CUSTOMER_NAME AS CST,ACCOUNT.BALANCE AS ACT
FROM CUSTOMER,DEPOSITOR,ACCOUNT
WHERE CUSTOMER.STREET LIKE 'GARIAHAT'
	AND CUSTOMER.CUSTOMER_NAME=DEPOSITOR.CUSTOMER_NAME
	AND ACCOUNT.ACCOUNT_NO=DEPOSITOR.ACCOUNT_NO) T1
GROUP BY T1.CST) T2
WHERE T2.CT>=3;

2)
SELECT DISTINCT BRANCH.BRANCH_NAME
FROM BRANCH,BRANCH BRANCH1
WHERE BRANCH.ASSETS>BRANCH1.ASSETS
	AND BRANCH1.BRANCH_CITY LIKE 'KOLKATA'
	AND BRANCH.BRANCH_CITY NOT LIKE 'KOLKATA';

3)
SELECT T2.CUST_NAME
FROM
(SELECT DISTINCT T1.CST CUST_NAME,COUNT(*) CT
FROM(SELECT CUSTOMER_NAME CST,BRANCH.BRANCH_NAME BNM
FROM DEPOSITOR,ACCOUNT,BRANCH
WHERE ACCOUNT.ACCOUNT_NO=DEPOSITOR.ACCOUNT_NO
	AND BRANCH.BRANCH_NAME=ACCOUNT.BRANCH_NAME
	AND BRANCH.BRANCH_CITY LIKE 'DURGAPUR') T1
GROUP BY T1.CST) T2
WHERE T2.CT=(SELECT COUNT(*)
FROM BRANCH
WHERE BRANCH_CITY LIKE 'DURGAPUR'
GROUP BY BRANCH.BRANCH_CITY);

4)
SELECT T.BRANCHS_NAME
FROM
(SELECT ACCOUNT.BRANCH_NAME BRANCHS_NAME,AVG(BALANCE) AS A
FROM ACCOUNT
GROUP BY ACCOUNT.BRANCH_NAME) T
WHERE T.A>10000;

5)
SELECT T.BRANCHS_NAME
FROM
(SELECT ACCOUNT.BRANCH_NAME BRANCHS_NAME,AVG(BALANCE) AS A
FROM ACCOUNT
GROUP BY ACCOUNT.BRANCH_NAME) T
WHERE T.A=
(SELECT MAX(T1.A)
FROM
(SELECT ACCOUNT.BRANCH_NAME BRANCHS_NAME,AVG(BALANCE) AS A
FROM ACCOUNT
GROUP BY ACCOUNT.BRANCH_NAME) T1);




---------------------------------------------------------------------------

		YEAR-2007,QUESTION-7
DROP TABLE EMPLOYEE;
CREATE TABLE EMPLOYEE
(	EMP_NAME VARCHAR2(30),
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(EMP_NAME)
);
DROP TABLE COMPANY;
CREATE TABLE COMPANY
(	COMPANY_NAME VARCHAR2(40),
	CITY VARCHAR2(30),
	PRIMARY KEY(COMPANY_NAME),
	CONSTRAINT CMP_NM CHECK(COMPANY_NAME IN ('IOC','ABC','XYZ'))
);

DROP TABLE WORKS;
CREATE TABLE WORKS
(	EMP_NAME VARCHAR2(30),
	COMPANY_NAME VARCHAR2(40),
	SALARY NUMBER(7,2) DEFAULT 10000,
	PRIMARY KEY(EMP_NAME,COMPANY_NAME),
	CONSTRAINT CMP_NM1 CHECK(COMPANY_NAME IN ('IOC','ABC','XYZ'))
);
DROP TABLE MANAGES;
CREATE TABLE MANAGES
(	EMP_NAME VARCHAR2(30),
	MANAGER_NAME VARCHAR2(30),
	PRIMARY KEY(EMP_NAME,MANAGER_NAME)
);

-----------------------------------------------------------------------------

		YEAR-2007,QUESTION-8
DROP TABLE SAILORS;
CREATE TABLE SAILORS
(	SID INT,
	S_NAME VARCHAR2(30),
	RATING INT,
	AGE INT,
	PRIMARY KEY(SID),
	CONSTRAINT SD CHECK(SID BETWEEN 100 AND 1000)
);

DROP TABLE BOATS;
CREATE TABLE BOATS
(	BID INT,
	BNAME VARCHAR2(30),
	COLOUR VARCHAR2(10),
	PRIMARY KEY(BID),
	CONSTRAINT BD CHECK(BID BETWEEN 100 AND 300),
	CONSTRAINT CLR CHECK(COLOUR IN ('RED','YELLOW','BLUE','GREEN'))
);	

DROP TABLE RESERVES;
CREATE TABLE RESERVES
(	SID INT,
	BID INT,
	DAY INT,
	PRIMARY KEY(SID,BID),
	CONSTRAINT SD1 CHECK(SID BETWEEN 100 AND 1000),
	CONSTRAINT BD1 CHECK(BID BETWEEN 100 AND 300)
);


=======================================================================

-------------------------------------------------------------------------------

		YEAR-2007,QUESTION-9(i)(d)
DROP TABLE FLIGHTS;
CREATE TABLE FLIGHTS
(	FLNO VARCHAR2(30),
	FROM1 VARCHAR2(30),
	TO1 VARCHAR2(30),
	DEPARTS VARCHAR2(10),
	ARRIVES VARCHAR2(10),
	PRIMARY KEY(FLNO)
);
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('102AI','KOLKATA','NEW YORK','19:07','21:45');
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('208BA','KOLKATA','DELHI','20:26','8:35');
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('603DE','KOLKATA','BERLIN','12:00','9:10');
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('003SJ','KOLKATA','PERTH','3:05','6:30');
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('065BA','KOLKATA','DHAKA','14:50','16:30');
INSERT INTO FLIGHTS(FLNO,FROM1,TO1,DEPARTS,ARRIVES)
VALUES('756CD','KOLKATA','COLUMBO','23:30','11:43');

DROP TABLE AIRCRAFT;
CREATE TABLE AIRCRAFT
(	AID VARCHAR2(10),
	ANAME VARCHAR(20),
	CRUISE_RANGE NUMBER(8,4),
	PRIMARY KEY(AID)
);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('BO568','BOEING',3000.50);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('AB234','AIRBUS',9989.64);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('BE034','British Aerospace',4354);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('CO654','Columbia-46',4658);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('BO462','BOEING',3065.50);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('BO588','BOEING',4681.50);
INSERT INTO AIRCRAFT(AID,ANAME,CRUISE_RANGE)
VALUES('AB233','AIRBUS',9865.64);

DROP TABLE EMPLOYEES;
CREATE TABLE EMPLOYEES
(	EID VARCHAR2(10),
	ENAME VARCHAR(20),
	SALARY NUMBER(7,2),
	PRIMARY KEY(EID)
);
INSERT INTO EMPLOYEES(EID,ENAME,SALARY)
VALUES('C/643','MR.A.BHATTACHARYA',20350.00);
INSERT INTO EMPLOYEES(EID,ENAME,SALARY)
VALUES('A/895','MR.D.K.DEY',56000.00);
INSERT INTO EMPLOYEES(EID,ENAME,SALARY)
VALUES('B/356','MR.A.K.KARMAKAR',30654.00);
INSERT INTO EMPLOYEES(EID,ENAME,SALARY)
VALUES('A/346','MR.S.SINGHANIA',52300.50);
INSERT INTO EMPLOYEES(EID,ENAME,SALARY)
VALUES('A/649','MISS.M.RAY',51006.50);

DROP TABLE CERTIFIED;
CREATE TABLE CERTIFIED
(	EID VARCHAR2(10),	
	AID VARCHAR2(10),
	PRIMARY KEY(EID,AID)
);
INSERT INTO CERTIFIED(EID,AID)
VALUES('C/643','BE034');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/895','BO568');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/346','BO568');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/649','BO462');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/895','BO588');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/895','AB234');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/895','CO654');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/346','AB233');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/346','CO654');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/649','AB234');
INSERT INTO CERTIFIED(EID,AID)
VALUES('A/649','CO654');
INSERT INTO CERTIFIED(EID,AID)
VALUES('B/356','BE034');


===========================================================

1)
SELECT SUM(SALARY) SAL_AMT
FROM EMPLOYEES;

2)
SELECT UNIQUE CERTIFIED.EID
FROM AIRCRAFT,CERTIFIED
WHERE AIRCRAFT.ANAME LIKE 'BOEING'
	AND AIRCRAFT.AID=CERTIFIED.AID;

3)
SELECT EID
FROM(
SELECT DISTINCT EID,COUNT(EID) CT
FROM CERTIFIED
GROUP BY EID
)
WHERE CT=3;

4)
(SELECT DISTINCT ENAME
FROM EMPLOYEES,CERTIFIED,AIRCRAFT
WHERE EMPLOYEES.EID=CERTIFIED.EID
	AND CERTIFIED.AID=AIRCRAFT.AID
	AND CRUISE_RANGE>3000)
MINUS
(SELECT DISTINCT ENAME
FROM EMPLOYEES,CERTIFIED,AIRCRAFT
WHERE EMPLOYEES.EID=CERTIFIED.EID
	AND CERTIFIED.AID=AIRCRAFT.AID
	AND AIRCRAFT.ANAME LIKE 'BOEING');

5)
SELECT ENAME
FROM 
(SELECT ROWNUM R,ENAME
FROM
(SELECT *
FROM EMPLOYEES
ORDER BY SALARY DESC))
WHERE R=2;
--------------------------------------------------------------------------------

		YEAR-2007,QUESTION-10
CREATE TABLE BRANCH10
(	BNO INT,
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PIN VARCHAR2(10),
	PRIMARY KEY(BNO)
);
CREATE TABLE STAFF
(	STAFF_NO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),
	DESIGNATION VARCHAR2(20),
	SEX VARCHAR2(6),
	DOB DATE,
	BNO INT,
	PRIMARY KEY(STAFF_NO)
);
CREATE TABLE PROPERTY_FOR_RENT
(	PNO INT,
	STREET VARCHAR2(40),
	CITY VARCHAR2(30),
	PIN VARCHAR2(10),
	TYPE VARCHAR2(4),
	ROOMS INT,
	RENT NUMBER(6,2),
	OWNER_NO INT,
	STAFF_NO INT,
	BNO INT,
	PRIMARY KEY(PNO)
);
CREATE TABLE CLIENT
(	CNO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),	
	TELNO VARCHAR2(15),
	PREF_TYPE VARCHAR2(4),
	MAX_RENT NUMBER(6,2),
	PRIMARY KEY(CNO)
);
CREATE TABLE PRIVATE_OWNER
(	ONO INT,
	FNAME VARCHAR2(30),
	LNAME VARCHAR2(30),
	ADDRESS VARCHAR2(40),
	TELNO VARCHAR2(15),
	PRIMARY KEY(ONO)
);
CREATE TABLE VIEWING
(	CNO INT,
	PNO INT,
	VIEW_DATE DATE,
	COMMENT1 VARCHAR2(50),
	PRIMARY KEY(PNO,CNO)
);

--------------------------------------------------------------------------















	