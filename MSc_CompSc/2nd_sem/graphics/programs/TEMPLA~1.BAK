#include<iostream.h>
#include<graphics.h>
#include<conio.h>
#include<math.h>
#include<process.h>
#include<stdlib.h>
#include<stdio.h>
#include<dos.h>
#include<time.h>


struct time t1,t2;
class algo
{
	private:
		int xMax,yMax;
	public:
		algo()
		{
		}
		void screenInitialize();
		void drawCoordinates();
		void timeint();
		~algo()
		{
			closegraph();
		}
};

void algo::screenInitialize()
{
	int gdriver = DETECT, gmode, errorcode;
	initgraph(&gdriver, &gmode, "C:\\tc\\bgi");
	outport(0x0378,0x00);
	errorcode = graphresult();
	if (errorcode != grOk)
	{
		cout<<"Graphics error: %s\n"<<grapherrormsg(errorcode);
		cout<<"Press any key to halt:";
		getch();
		exit(0);
	}
	xMax=getmaxx();
	yMax=getmaxy();

}

void algo::drawCoordinates()
{
	char msg[80];
	sprintf(msg,"Title");
	outtextxy(xMax/2-textwidth(msg)/2,0,msg);
	line(4,yMax/2,xMax-4,yMax/2);
	line(xMax/2,textheight(msg),xMax/2,yMax-2*textheight(msg));
	outtextxy(9,yMax/2+5,"X");
	gotoxy(3,16);
	cout<<"'";
	outtextxy(xMax-textwidth("X")-9,yMax/2+5,"X");
	outtextxy(xMax/2,textheight(msg)+5,"Y");
	outtextxy(xMax/2,yMax-3*textheight("Y")-4,"Y");
	gotoxy(42,29);
	cout<<"'";
	sprintf(msg,"Time:- ");
	gotoxy(2,30);
	cout<<msg;
	sprintf(msg,"Scale:- 1 Unit = 4 Pixels");
	gotoxy(55,30);
	cout<<msg;
	rectangle(4,textheight(msg),xMax-4,yMax-2*textheight(msg)+1);
}

void algo::timeint()
{
	int min,sec;
	long int ssec;
	if(t1.ti_hund>t2.ti_hund)
	{
		ssec=100+t1.ti_hund-t2.ti_hund;
		(t1.ti_sec)=(t1.ti_sec)-1;
	}
	else
		ssec=t2.ti_hund-t1.ti_hund;
	if(t1.ti_sec>t2.ti_sec)
	{
		sec=60+t1.ti_sec-t2.ti_sec;
		(t1.ti_min)=(t1.ti_min)-1;
	}
	else
		sec=t2.ti_sec-t1.ti_sec;
	min=t2.ti_min-t1.ti_min;
//	printf("%2dmin :%2dsec :%ldhsec",t1.ti_min,t1.ti_sec,t1.ti_hund);
//	printf("\n%2dmin :%2dsec :%ldhsec",t2.ti_min,t2.ti_sec,t2.ti_hund);
	gotoxy(10,30);
	printf("%dmin :%dsec :%ldhsec",min,sec,ssec);
//	rectangle(4,textheight("A"),xMax-4,yMax-2*textheight("A")+1);
}

int main()
{
	algo ob;
	ob.screenInitialize();
	ob.drawCoordinates();
	gettime(&t1);
//	printf("The current time is: %2d:%02d:%02d.%06d\n",t1.ti_hour, t1.ti_min, t1.ti_sec, t1.ti_hund);
	delay(2000);
	gettime(&t2);
  //	printf("The current time is: %2d:%02d:%02d.%06d\n",t2.ti_hour, t2.ti_min, t2.ti_sec, t2.ti_hund);
	ob.timeint();
	getch();
	/*cleardevice();
	ob.screenInitialize();
	ob.drawCoordinates();*/
	getch();
	return 0;
}